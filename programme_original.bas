10 SCREEN 0:WIDTH 40:KEY OFF:CLS:RANDOMIZE TIMER
20 R$="2122232412223242212223241222324231223223122223333122322312222333212232331322322321223233132232232232233322322333223223332232233321222333122232131121222312223132212213231213233311211213122232331222323212232231221223221122223"
30 FOR i=1 TO 3:FOR j=0 TO 3:FOR K=1 TO 4:A$(i,j,k)=MID$(R$,32*I-31+2+K-2+8*J,2):NEXT KJI
' TS=T$ ?
40 SC=0:S$=CHR$(219):DIM B$(23),TS(24,11):FOR I=1 TO 23:B$(I)=SPACE(9):NEXT I
50 COLOR 11:FOR I=3 TO 23:LOCATE I,10:PRINT S$;:TS(I,1)=11:LOCATE i,20:PRINT S$;:TS(I,11)=11:NEXT I
60 LOCATE 24,10:PRINT STRING$(11,S$);:FOR K=1 TO 11:TS(24,K)=11:NEXT K
70 COLOR 7:XA=0:XO=1:YO=13:K=1:H=8:S=INT(RND*7+1):LOCATE 1,1:PRINT "SCORE ";SC
80 COLOR S:R$="":A$=S$:PP=S:GOSUB 150
90 FOR I=1 TO 40:R$=RIGHT$(INKEY$,1):IF R$<>="" THEN 100 ELSE NEXT I
100 A$=" ":PP=0:GOSUB 150:XI=XO:YI=YO:KI=K
110 T=T+1:IF (T MOD H=0 OR R$=" ") AND R$<>"1" AND R$<>"3" THEN XA=XO:XO=XO+1
120 K=(K-3*(R$="2")-(R$="5")) MOD 4:YO=YO+(1 AND R$="3")-(1 AND R$="1")
130 P=0:FOR I=1 TO 4:=P+TS(XO+VAL(RIGHT$(A$(S,K,I),1)),YO-9+VAL(LEFT$(A$(S,K,I),1))):NEXT I:IF P<>0 THEN XO=XI:YO=YI:K=KI
140 IF XA=XO THEN A$=S$:PP=S:TT=1:GOSUB 150:P=1:GOSUB 180:IF XO<>1 THEN GOTO 70 ELSE PRINT "C'est fini":END ELSE GOTO 80
150 FOR I=1 TO 4:TX=XO+VAL(RIGHT$(A$(S,K,I),1)):TY=YO+VAL(LEFT$(A$(S?K,I),1)):LOCATE TX,TY:PRINT A$;:TS(TX,TY-9)=PP
160 IF TT=1 THEN MID$(B$(TX),TY-10)=A$
170 NEXT I:TT=0:RETURN
180 P=3*P:FOR I=23 TO 1 STEP -1
190 IF B$(I)=STRING$(9,S$) THEN FOR J=I TO 2 STEP -1:B$(J)=B$(J-1):FOR L=1 TO 11:TS(J,L)=TS(J-1,L): NEXT L,J:B$(1)=SPACE$(9):FOR L=2 TO 10:TS(1,L)=0:NEXT L:TS(3,1)=11:TS(3,11)=11:PRINT CHR$(7);:SC=SC+P:GOTO 180
200 IF P<>3 THEN FOR L=1 TO 11:LOCATE I,9+L:COLOR TS(I,L):PRINT S$:NEXT
210 NEXT I:RETURN